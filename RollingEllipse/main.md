# Rolling Ellipse

An ellipse <var>E</var>(<var>a</var>, <var>b</var>) is given at its initial position by equation:<br />
$\frac {x^2} {a^2} + \frac {(y - b)^2} {b^2} = 1$

The ellipse rolls without slipping along the <var>x</var> axis for one complete turn. Interestingly, the length of the curve generated by a focus is independent from the size of the minor axis:<br />
$F(a,b) =  2 \pi \text{ } max(a,b)$

<div align="center"><img src="https://projecteuler.net/project/images/p525-rolling-ellipse-1.gif" alt="p525-rolling-ellipse-1.gif" /></div>

This is not true for the curve generated by the ellipse center. Let <var>C</var>(<var>a</var>,<var>b</var>) be the length of the curve generated by the center of the ellipse as it rolls without slipping for one turn.

<div align="center"><img src="https://projecteuler.net/project/images/p525-rolling-ellipse-2.gif" alt="p525-rolling-ellipse-2.gif" /></div>

You are given <var>C</var>(2, 4) ~ 21.38816906.

Find <var>C</var>(1, 4) + <var>C</var>(3, 4). Give your answer rounded to 8 digits behind the decimal point in the form <i>ab.cdefghij</i>.

## Solution

Fix values for $a, b$ where $a \le b$. Let's compute the arc length $L(t)$ of the ellipse starting at $(b, 0)$ and going to $(b \cos(t), a \sin(t))$ with the parametrization $x = b \cos(t), y = a \sin(t)$ where $0 \le t \le \pi/2$. Then

$$
\begin{align*}
L(t)
&= \int_0^t \sqrt{b^2 \sin^2(s) + a^2 \cos^2(s)} \, ds \\
&= \int_0^t \sqrt{b^2 (1 - \cos^2(s)) + a^2 \cos^2(s)} \, ds \\
&= b \int_0^t \sqrt{1 - (1 - \frac{a^2}{b^2}) \cos^2(s)} \, ds \\
&= b \int_0^t \sqrt{1 - \epsilon^2 \cos^2(s)} \, ds \\
\end{align*}
$$

where the eccentricity of the ellipse is $\epsilon = \sqrt{1 - \frac{a^2}{b^2}}$.

For the rolling ellipse let $S$ be the point on the ellipse that touches the floor when the figure starts rolling, let $T$ be the point where the ellipse touches the floor at time $t$ (which will go from $0$ to $\pi / 2$, where $2 \pi$ indicates a full rotation), and let $C$ be the center of the ellipse. Draw a perpendicular from the floor to $C$. Let $P$ be the point where the perpendicular intersects the floor. Then $C = (\overgroup{ST} + \overline{TP}, \overline{PC})$, as the length we have traveled horizontally must correspond to the arc length of the ellipse we have covered. From the previous paragraph we have $\overgroup{ST} = L(t)$. From the pythagorean formula we have $\overline{TP}^2 + \overline{PC}^2 = \overline{TC}^2$ and we know $\overline{TC}^2 = b^2 \cos^2(t) + a^2 \sin^2(t)$. Therefore we only need to find $\overline{PC}$ to obtain a parametrization for $C$.

Rotate the system so that the semi-major axis of the ellipse coincides with the horizontal axis and $C$ coincides with $O$. Then the floor has slope equal to the derivative at $T$ of the curve. Notice that

$$
\begin{align*}
\frac{x^2}{b^2} + \frac{y^2}{a^2} = 1
&\Rightarrow \frac{2x}{b^2} + \frac{2yy'}{a^2} = 0 \\
&\Rightarrow y' = - \frac{a^2 x}{b^2 y} \\
&\Rightarrow y' = - \frac{a}{b} \cot(t) \\
\end{align*}
$$

and this is the slope of the line $\overline{TP}$. Therefore the slope of the line $\overline{PC}$ is

$$
m = \frac{b}{a} \tan(t)
$$

with this we can define the following system of linear equations to find the value of $\overline{PC}$

$$
\begin{cases}
y = \frac{b}{a} \tan(t) x \\
y - a \sin(t) = - \frac{a}{b} \cot(t) \cdot (x - b \cos(t)) \\
\end{cases}
$$

Solving for $x$ we get

$$
\begin{align*}
&\iff \frac{b}{a} \tan(t) x = - \frac{a}{b} \cot(t) \cdot (x - b \cos(t)) + a \sin(t) \\

&\iff \left( \frac{b}{a} \tan(t) + \frac{a}{b} \cot(t) \right) x = a \left( \cot(t) \cdot \cos(t) + \sin(t) \right) \\

&\iff \sin(t) \left( \frac{b}{a} \tan(t) + \frac{a}{b} \cot(t) \right) x = a \left( \cos^2(t) + \sin^2(t) \right) \\

&\iff x = \frac{a}{\sin(t) \left( \frac{b}{a} \tan(t) + \frac{a}{b} \cot(t) \right)} \\
\end{align*}
$$

which gives us a way of computing $\overline{PC}$ as follows

$$
\begin{align*}
\overline{PC}
&= \sqrt{x^2 + y^2} \\
&= \sqrt{x^2 + \frac{b^2}{a^2} \tan^2(t) x^2} \\
&= x \sqrt{1 + \frac{b^2}{a^2} \tan^2(t)} \\

&= \frac{a}{\sin(t) \left( \frac{b}{a} \tan(t) + \frac{a}{b} \cot(t) \right)} \cdot \sqrt{1 + \frac{b^2}{a^2} \tan^2(t)} \\

&= \frac{1}{\frac{b}{a} \tan(t) + \frac{a}{b} \cot(t)} \cdot \sqrt{\frac{a^2}{\sin^2(t)} + \frac{b^2}{\cos^2(t)}} \\

&= \frac{ab}{\sqrt{a^2 \cos^2(t) + b^2 \sin^2(t)}} \\
\end{align*}
$$

Which implies

$$
\begin{align*}
\overline{TP}
&= \sqrt{b^2 \cos^2(t) + a^2 \sin^2(t) - \frac{a^2 b^2}{a^2 \cos^2(t) + b^2 \sin^2(t)}} \\
&= \sqrt{\frac{(b^2 \cos^2(t) + a^2 \sin^2(t)) (a^2 \cos^2(t) + b^2 \sin^2(t)) - a^2 b^2}{a^2 \cos^2(t) + b^2 \sin^2(t)}} \\
&= \sqrt{\frac{(b^2 \cos^2(t) + a^2 (1 - \cos^2(t))) (a^2 (1 - \sin^2(t)) + b^2 \sin^2(t)) - a^2 b^2}{a^2 \cos^2(t) + b^2 \sin^2(t)}} \\
&= \sqrt{\frac{((b^2 - a^2) \cos^2(t) + a^2) (a^2 + (b^2 - a^2) \sin^2(t)) - a^2 b^2}{a^2 \cos^2(t) + b^2 \sin^2(t)}} \\
&= \sqrt{\frac{a^4 + (b^2 - a^2)^2 \sin^2(t) \cos^2(t) + a^2 (b^2 - a^2) - a^2 b^2}{a^2 \cos^2(t) + b^2 \sin^2(t)}} \\
&= \sqrt{\frac{(b^2 - a^2)^2 \sin^2(t) \cos^2(t)}{a^2 \cos^2(t) + b^2 \sin^2(t)}} \\
&= \frac{(b^2 - a^2) \sin(t) \cos(t)}{\sqrt{a^2 \cos^2(t) + b^2 \sin^2(t)}} \\
\end{align*}
$$

Thanks to symmetry we only need to compute the arc length integral for the interval $0$ to $\pi/2$ and we have to multiply it by $4$. Therefore if $f(t) = (x(t), y(t))$ is the parametrization of the curve, then

$$
C(a, b) = 4 \int_0^{\pi/2} \sqrt{x'(t)^2 + y'(t)^2} \, dt
$$

where

$$
x(t) = L(t) + \frac{(b^2 - a^2) \sin(t) \cos(t)}{\sqrt{a^2 \cos^2(t) + b^2 \sin^2(t)}} \\
\Rightarrow x'(t) = b \sqrt{1 - \epsilon^2 \cos^2(t)} + \frac{(b^2 - a^2) (a^2 \cos^4(t) - b^2 \sin^4(t))}{(a^2 \cos^2(t) + b^2 \sin^2(t))^{3/2}} \\
$$

and

$$
y(t) = \frac{ab}{\sqrt{a^2 \cos^2(t) + b^2 \sin^2(t)}} \\
\Rightarrow y'(t) = \frac{ab (a^2 - b^2) \sin(t) \cos(t)}{(a^2 \cos^2(t) + b^2 \sin^2(t))^{3/2}}
$$

## Appendix A: Numerical Integration (Trapezoidal Rule)

We can approximate an integral using the following scheme

$$
\begin{align*}
\int_a^b f(x) \, dx
&\approx \sum_{k = 0}^{n-1} \frac{f(a + \frac{(b - a) k}{n}) + f(a + \frac{(b - a) (k + 1)}{n})}{2} \cdot \frac{b - a}{n} \\
&\approx \frac{b - a}{n} \left( \frac{f(a) + f(b)}{2} + \sum_{k = 1}^{n-1} f \left( a + \frac{(b - a) k}{n} \right) \right) \\
\end{align*}
$$

This is clearly true as the RHS is just a Riemann sum corresponding to the integral on the LHS, and as $n \rightarrow \infty$ the approximation error should go to zero.